%
\begin{isabellebody}%
\setisabellecontext{SafetyOracle}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ SafetyOracle\isanewline
\isanewline
\isakeyword{imports}\ Main\ CBCCasper\ LatestMessage\ StateTransition\isanewline
\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ latest{\isacharunderscore}justifications{\isacharunderscore}from{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}state\ {\isasymRightarrow}\ validator\ {\isasymRightarrow}\ state\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}latest{\isacharunderscore}justifications{\isacharunderscore}from{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators\ {\isasymsigma}\ v\ {\isacharequal}\ \isanewline
\ \ \ \ \ \ {\isacharbraceleft}justification\ m\ {\isacharbar}\ m{\isachardot}\ m\ {\isasymin}\ latest{\isacharunderscore}messages{\isacharunderscore}from{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators\ {\isasymsigma}\ v{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Protocol{\isacharparenright}\ latest{\isacharunderscore}justifications{\isacharunderscore}from{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators{\isacharunderscore}type\ {\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}{\isasymforall}\ {\isasymsigma}\ v{\isachardot}\ {\isasymsigma}\ {\isasymin}\ {\isasymSigma}\ {\isasymand}\ v\ {\isasymin}\ V\ {\isasymlongrightarrow}\ latest{\isacharunderscore}justifications{\isacharunderscore}from{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators\ {\isasymsigma}\ v\ {\isasymsubseteq}\ {\isasymSigma}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ M{\isacharunderscore}type\ latest{\isacharunderscore}messages{\isacharunderscore}from{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators{\isacharunderscore}type\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ \ agreeing{\isacharunderscore}validators\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}consensus{\isacharunderscore}value{\isacharunderscore}property\ {\isacharasterisk}\ state{\isacharparenright}\ {\isasymRightarrow}\ validator\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}agreeing{\isacharunderscore}validators\ {\isacharparenleft}p{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}v\ {\isasymin}\ observed{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators\ {\isasymsigma}{\isachardot}\ {\isasymforall}\ c\ {\isasymin}\ latest{\isacharunderscore}estimates{\isacharunderscore}from{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators\ {\isasymsigma}\ v{\isachardot}\ p\ c{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Protocol{\isacharparenright}\ agreeing{\isacharunderscore}validators{\isacharunderscore}type\ {\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}{\isasymforall}\ {\isasymsigma}\ {\isasymin}\ {\isasymSigma}{\isachardot}\ agreeing{\isacharunderscore}validators\ {\isacharparenleft}p{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isasymsubseteq}\ V{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observed{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ observed{\isacharunderscore}type{\isacharunderscore}for{\isacharunderscore}state\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ disagreeing{\isacharunderscore}validators\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}consensus{\isacharunderscore}value{\isacharunderscore}property\ {\isacharasterisk}\ state{\isacharparenright}\ {\isasymRightarrow}\ validator\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}disagreeing{\isacharunderscore}validators\ {\isacharparenleft}p{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}v\ {\isasymin}\ observed{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators\ {\isasymsigma}{\isachardot}\ {\isasymexists}\ c\ {\isasymin}\ latest{\isacharunderscore}estimates{\isacharunderscore}from{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators\ {\isasymsigma}\ v{\isachardot}\ {\isasymnot}\ p\ c{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Protocol{\isacharparenright}\ disagreeing{\isacharunderscore}validators{\isacharunderscore}type\ {\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}{\isasymforall}\ {\isasymsigma}\ {\isasymin}\ {\isasymSigma}{\isachardot}\ disagreeing{\isacharunderscore}validators\ {\isacharparenleft}p{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isasymsubseteq}\ V{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ observed{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ observed{\isacharunderscore}type{\isacharunderscore}for{\isacharunderscore}state\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Params{\isacharparenright}\ weight{\isacharunderscore}measure\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}validator\ set\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}weight{\isacharunderscore}measure\ v{\isacharunderscore}set\ {\isacharequal}\ sum\ W\ v{\isacharunderscore}set{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Params{\isacharparenright}\ is{\isacharunderscore}majority\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}validator\ set\ {\isacharasterisk}\ state{\isacharparenright}\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}is{\isacharunderscore}majority\ {\isacharparenleft}v{\isacharunderscore}set{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isacharequal}\ {\isacharparenleft}weight{\isacharunderscore}measure\ v{\isacharunderscore}set\ {\isachargreater}\ {\isacharparenleft}weight{\isacharunderscore}measure\ V\ {\isacharminus}\ weight{\isacharunderscore}measure\ {\isacharparenleft}equivocating{\isacharunderscore}validators\ {\isasymsigma}{\isacharparenright}{\isacharparenright}\ div\ {\isadigit{2}}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Protocol{\isacharparenright}\ is{\isacharunderscore}majority{\isacharunderscore}driven\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}consensus{\isacharunderscore}value{\isacharunderscore}property\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}is{\isacharunderscore}majority{\isacharunderscore}driven\ p\ {\isacharequal}\ {\isacharparenleft}{\isasymforall}\ {\isasymsigma}\ c{\isachardot}\ {\isasymsigma}\ {\isasymin}\ {\isasymSigma}\ {\isasymand}\ c\ {\isasymin}\ C\ {\isasymand}\ is{\isacharunderscore}majority\ {\isacharparenleft}agreeing{\isacharunderscore}validators\ {\isacharparenleft}p{\isacharcomma}\ {\isasymsigma}{\isacharparenright}{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\isasymforall}\ c\ {\isasymin}\ {\isasymepsilon}\ {\isasymsigma}{\isachardot}\ p\ c{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Protocol{\isacharparenright}\ is{\isacharunderscore}max{\isacharunderscore}driven\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}consensus{\isacharunderscore}value{\isacharunderscore}property\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}is{\isacharunderscore}max{\isacharunderscore}driven\ p\ {\isacharequal}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\isasymforall}\ {\isasymsigma}\ c{\isachardot}\ {\isasymsigma}\ {\isasymin}\ {\isasymSigma}\ {\isasymand}\ c\ {\isasymin}\ C\ {\isasymand}\ weight{\isacharunderscore}measure\ {\isacharparenleft}agreeing{\isacharunderscore}validators\ {\isacharparenleft}p{\isacharcomma}\ {\isasymsigma}{\isacharparenright}{\isacharparenright}\ {\isachargreater}\ weight{\isacharunderscore}measure\ {\isacharparenleft}disagreeing{\isacharunderscore}validators\ {\isacharparenleft}p{\isacharcomma}\ {\isasymsigma}{\isacharparenright}{\isacharparenright}\ {\isasymlongrightarrow}\ c\ {\isasymin}\ {\isasymepsilon}\ {\isasymsigma}\ {\isasymand}\ p\ c{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ later{\isacharunderscore}disagreeing{\isacharunderscore}messages\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}consensus{\isacharunderscore}value{\isacharunderscore}property\ {\isacharasterisk}\ message\ {\isacharasterisk}\ validator\ {\isacharasterisk}\ state{\isacharparenright}\ {\isasymRightarrow}\ message\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}later{\isacharunderscore}disagreeing{\isacharunderscore}messages\ {\isacharparenleft}p{\isacharcomma}\ m{\isacharcomma}\ v{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}m{\isacharprime}\ {\isasymin}\ later{\isacharunderscore}from\ {\isacharparenleft}m{\isacharcomma}\ v{\isacharcomma}\ {\isasymsigma}{\isacharparenright}{\isachardot}\ {\isasymnot}\ p\ {\isacharparenleft}est\ m{\isacharprime}{\isacharparenright}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Protocol{\isacharparenright}\ later{\isacharunderscore}disagreeing{\isacharunderscore}messages{\isacharunderscore}type\ {\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}{\isasymforall}\ p\ {\isasymsigma}\ v\ m{\isachardot}\ {\isasymsigma}\ {\isasymin}\ {\isasymSigma}\ {\isasymand}\ v\ {\isasymin}\ V\ {\isasymand}\ m\ {\isasymin}\ M\ {\isasymlongrightarrow}\ later{\isacharunderscore}disagreeing{\isacharunderscore}messages\ {\isacharparenleft}p{\isacharcomma}\ m{\isacharcomma}\ v{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isasymsubseteq}\ M{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ later{\isacharunderscore}from{\isacharunderscore}type{\isacharunderscore}for{\isacharunderscore}state\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ is{\isacharunderscore}clique\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}validator\ set\ {\isacharasterisk}\ consensus{\isacharunderscore}value{\isacharunderscore}property\ {\isacharasterisk}\ state{\isacharparenright}\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \isakeyword{where}\isanewline
\ \ \ {\isachardoublequoteopen}is{\isacharunderscore}clique\ {\isacharparenleft}v{\isacharunderscore}set{\isacharcomma}\ p{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isacharequal}\ \isanewline
\ \ \ \ \ {\isacharparenleft}{\isasymforall}\ v\ {\isasymin}\ v{\isacharunderscore}set{\isachardot}\ v{\isacharunderscore}set\ {\isasymsubseteq}\ agreeing{\isacharunderscore}validators\ {\isacharparenleft}p{\isacharcomma}\ the{\isacharunderscore}elem\ {\isacharparenleft}latest{\isacharunderscore}justifications{\isacharunderscore}from{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators\ {\isasymsigma}\ v{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ \ {\isasymand}\ \ {\isacharparenleft}{\isasymforall}\ \ v{\isacharprime}\ {\isasymin}\ v{\isacharunderscore}set{\isachardot}\ later{\isacharunderscore}disagreeing{\isacharunderscore}messages\ {\isacharparenleft}p{\isacharcomma}\ the{\isacharunderscore}elem\ {\isacharparenleft}latest{\isacharunderscore}messages{\isacharunderscore}from{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators\ {\isacharparenleft}the{\isacharunderscore}elem\ {\isacharparenleft}latest{\isacharunderscore}justifications{\isacharunderscore}from{\isacharunderscore}non{\isacharunderscore}equivocating{\isacharunderscore}validators\ {\isasymsigma}\ v{\isacharparenright}{\isacharparenright}\ v{\isacharprime}{\isacharparenright}{\isacharcomma}\ v{\isacharprime}{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isacharequal}\ {\isasymemptyset}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Protocol{\isacharparenright}\ later{\isacharunderscore}from{\isacharunderscore}not{\isacharunderscore}affected{\isacharunderscore}by{\isacharunderscore}minimal{\isacharunderscore}transitions\ {\isacharcolon}\isanewline
\ \ {\isachardoublequoteopen}{\isasymforall}\ {\isasymsigma}\ {\isasymsigma}{\isacharprime}\ m\ m{\isacharprime}\ v{\isachardot}\ {\isacharparenleft}{\isasymsigma}{\isacharcomma}\ {\isasymsigma}{\isacharprime}{\isacharparenright}\ {\isasymin}\ minimal{\isacharunderscore}transitions\isanewline
\ \ {\isasymlongrightarrow}\ m{\isacharprime}\ {\isacharequal}\ the{\isacharunderscore}elem\ {\isacharparenleft}{\isasymsigma}{\isacharprime}\ {\isacharminus}\ {\isasymsigma}{\isacharparenright}\isanewline
\ \ {\isasymlongrightarrow}\ v\ {\isasymin}\ V\ {\isacharminus}\ {\isacharbraceleft}sender\ m{\isacharprime}{\isacharbraceright}\isanewline
\ \ {\isasymlongrightarrow}\ later{\isacharunderscore}from\ {\isacharparenleft}m{\isacharcomma}\ v{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isacharequal}\ later{\isacharunderscore}from\ {\isacharparenleft}m{\isacharcomma}\ v{\isacharcomma}\ {\isasymsigma}{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}rule{\isacharcomma}\ rule{\isacharcomma}\ rule{\isacharcomma}\ rule{\isacharcomma}\ rule{\isacharcomma}\ rule{\isacharcomma}\ rule{\isacharcomma}\ rule{\isacharparenright}\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ {\isasymsigma}\ {\isasymsigma}{\isacharprime}\ m\ m{\isacharprime}\ v\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\isasymsigma}{\isacharcomma}\ {\isasymsigma}{\isacharprime}{\isacharparenright}\ {\isasymin}\ minimal{\isacharunderscore}transitions{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}m{\isacharprime}\ {\isacharequal}\ the{\isacharunderscore}elem\ {\isacharparenleft}{\isasymsigma}{\isacharprime}\ {\isacharminus}\ {\isasymsigma}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ V\ {\isacharminus}\ {\isacharbraceleft}sender\ m{\isacharprime}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}later{\isacharunderscore}from\ {\isacharparenleft}m{\isacharcomma}v{\isacharcomma}{\isasymsigma}{\isacharparenright}\ {\isacharequal}\ {\isacharbraceleft}m{\isacharprime}{\isacharprime}\ {\isasymin}\ {\isasymsigma}{\isachardot}\ sender\ m{\isacharprime}{\isacharprime}\ {\isacharequal}\ v\ {\isasymand}\ justified\ m\ m{\isacharprime}{\isacharprime}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ later{\isacharunderscore}from{\isacharunderscore}def\ from{\isacharunderscore}sender{\isacharunderscore}def\ later{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}\ {\isacharbraceleft}m{\isacharprime}{\isacharprime}\ {\isasymin}\ {\isasymsigma}{\isachardot}\ sender\ m{\isacharprime}{\isacharprime}\ {\isacharequal}\ v\ {\isasymand}\ justified\ m\ m{\isacharprime}{\isacharprime}{\isacharbraceright}\ {\isasymunion}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\ \ \ \ \isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}\ {\isacharbraceleft}m{\isacharprime}{\isacharprime}\ {\isasymin}\ {\isasymsigma}{\isachardot}\ sender\ m{\isacharprime}{\isacharprime}\ {\isacharequal}\ v\ {\isasymand}\ justified\ m\ m{\isacharprime}{\isacharprime}{\isacharbraceright}\ {\isasymunion}\ {\isacharbraceleft}m{\isacharprime}{\isacharprime}\ {\isasymin}\ {\isacharbraceleft}m{\isacharprime}{\isacharbraceright}{\isachardot}\ sender\ m{\isacharprime}{\isacharprime}\ {\isacharequal}\ v{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}m{\isacharprime}{\isacharprime}\ {\isasymin}\ {\isacharbraceleft}m{\isacharprime}{\isacharbraceright}{\isachardot}\ sender\ m{\isacharprime}{\isacharprime}\ {\isacharequal}\ v{\isacharbraceright}\ {\isacharequal}\ {\isasymemptyset}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}v\ {\isasymin}\ V\ {\isacharminus}\ {\isacharbraceleft}sender\ m{\isacharprime}{\isacharbraceright}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}\ {\isacharbraceleft}m{\isacharprime}{\isacharprime}\ {\isasymin}\ {\isasymsigma}{\isachardot}\ sender\ m{\isacharprime}{\isacharprime}\ {\isacharequal}\ v\ {\isasymand}\ justified\ m\ m{\isacharprime}{\isacharprime}{\isacharbraceright}\ {\isasymunion}\ {\isacharbraceleft}m{\isacharprime}{\isacharprime}\ {\isasymin}\ {\isacharbraceleft}m{\isacharprime}{\isacharbraceright}{\isachardot}\ sender\ m{\isacharprime}{\isacharprime}\ {\isacharequal}\ v\ {\isasymand}\ justified\ m\ m{\isacharprime}{\isacharprime}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharminus}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sender\ m{\isacharprime}\ {\isacharequal}\ v\ {\isasymLongrightarrow}\ justified\ m\ m{\isacharprime}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}v\ {\isasymin}\ V\ {\isacharminus}\ {\isacharbraceleft}sender\ m{\isacharprime}{\isacharbraceright}{\isacartoucheclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}\ {\isacharbraceleft}m{\isacharprime}{\isacharprime}\ {\isasymin}\ {\isasymsigma}\ {\isasymunion}\ {\isacharbraceleft}m{\isacharprime}{\isacharbraceright}{\isachardot}\ sender\ m{\isacharprime}{\isacharprime}\ {\isacharequal}\ v\ {\isasymand}\ justified\ m\ m{\isacharprime}{\isacharprime}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}\ {\isacharbraceleft}m{\isacharprime}{\isacharprime}\ {\isasymin}\ {\isasymsigma}{\isacharprime}{\isachardot}\ sender\ m{\isacharprime}{\isacharprime}\ {\isacharequal}\ v\ {\isasymand}\ justified\ m\ m{\isacharprime}{\isacharprime}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymsigma}{\isacharprime}\ {\isacharequal}\ \ {\isasymsigma}\ {\isasymunion}\ {\isacharbraceleft}m{\isacharprime}{\isacharbraceright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharparenleft}{\isasymsigma}{\isacharcomma}\ {\isasymsigma}{\isacharprime}{\isacharparenright}\ {\isasymin}\ minimal{\isacharunderscore}transitions{\isacartoucheclose}\ {\isacartoucheopen}m{\isacharprime}\ {\isacharequal}\ the{\isacharunderscore}elem\ {\isacharparenleft}{\isasymsigma}{\isacharprime}\ {\isacharminus}\ {\isasymsigma}{\isacharparenright}{\isacartoucheclose}\ minimal{\isacharunderscore}transitions{\isacharunderscore}reconstruction\ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}\ later{\isacharunderscore}from\ {\isacharparenleft}m{\isacharcomma}v{\isacharcomma}{\isasymsigma}{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}simp\ add{\isacharcolon}\ later{\isacharunderscore}from{\isacharunderscore}def\ from{\isacharunderscore}sender{\isacharunderscore}def\ later{\isacharunderscore}def{\isacharparenright}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}later{\isacharunderscore}from\ {\isacharparenleft}m{\isacharcomma}\ v{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isacharequal}\ later{\isacharunderscore}from\ {\isacharparenleft}m{\isacharcomma}\ v{\isacharcomma}\ {\isasymsigma}{\isacharprime}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}{\isacharbraceleft}m{\isacharprime}{\isacharprime}\ {\isasymin}\ {\isasymsigma}\ {\isasymunion}\ {\isacharbraceleft}m{\isacharprime}{\isacharbraceright}{\isachardot}\ sender\ m{\isacharprime}{\isacharprime}\ {\isacharequal}\ v\ {\isasymand}\ justified\ m\ m{\isacharprime}{\isacharprime}{\isacharbraceright}\ {\isacharequal}\ {\isacharbraceleft}m{\isacharprime}{\isacharprime}\ {\isasymin}\ {\isasymsigma}{\isacharprime}{\isachardot}\ sender\ m{\isacharprime}{\isacharprime}\ {\isacharequal}\ v\ {\isasymand}\ justified\ m\ m{\isacharprime}{\isacharprime}{\isacharbraceright}{\isacartoucheclose}\ calculation\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\ \isanewline
\isacommand{fun}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Params{\isacharparenright}\ gt{\isacharunderscore}threshold\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}validator\ set\ {\isacharasterisk}\ state{\isacharparenright}\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}gt{\isacharunderscore}threshold\ {\isacharparenleft}v{\isacharunderscore}set{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\isanewline
\ \ \ \ \ \ \ {\isacharequal}\ {\isacharparenleft}weight{\isacharunderscore}measure\ v{\isacharunderscore}set\ {\isachargreater}\ {\isacharparenleft}weight{\isacharunderscore}measure\ v{\isacharunderscore}set{\isacharparenright}\ div\ {\isadigit{2}}\ {\isacharplus}\ t\ \ {\isacharminus}\ weight{\isacharunderscore}measure\ {\isacharparenleft}equivocating{\isacharunderscore}validators\ {\isasymsigma}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{in}\ Params{\isacharparenright}\ is{\isacharunderscore}clique{\isacharunderscore}oracle\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}{\isacharparenleft}validator\ set\ {\isacharasterisk}\ state\ {\isacharasterisk}\ consensus{\isacharunderscore}value{\isacharunderscore}property{\isacharparenright}\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}is{\isacharunderscore}clique{\isacharunderscore}oracle\ {\isacharparenleft}v{\isacharunderscore}set{\isacharcomma}\ {\isasymsigma}{\isacharcomma}\ p{\isacharparenright}\isanewline
\ \ \ \ \ \ \ {\isacharequal}\ {\isacharparenleft}is{\isacharunderscore}clique\ {\isacharparenleft}v{\isacharunderscore}set\ {\isacharminus}\ {\isacharparenleft}equivocating{\isacharunderscore}validators\ {\isasymsigma}{\isacharparenright}{\isacharcomma}\ p{\isacharcomma}\ {\isasymsigma}{\isacharparenright}\ {\isasymand}\ gt{\isacharunderscore}threshold\ {\isacharparenleft}v{\isacharunderscore}set\ {\isacharminus}\ {\isacharparenleft}equivocating{\isacharunderscore}validators\ {\isasymsigma}{\isacharparenright}{\isacharcomma}\ {\isasymsigma}{\isacharparenright}{\isacharparenright}{\isachardoublequoteclose}\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/work/blockchain/LayerXcom/cbc-casper-proof/Isabelle/SafetyOracle.thy%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%14=4%:%
%:%15=5%:%
%:%20=5%:%
%:%23=6%:%
%:%24=7%:%
%:%25=8%:%
%:%26=9%:%
%:%27=10%:%
%:%28=11%:%
%:%29=12%:%
%:%30=13%:%
%:%31=14%:%
%:%32=15%:%
%:%33=16%:%
%:%34=17%:%
%:%35=18%:%
%:%36=18%:%
%:%37=19%:%
%:%38=20%:%
%:%39=21%:%
%:%40=22%:%
%:%41=23%:%
%:%42=23%:%
%:%43=24%:%
%:%46=25%:%
%:%50=25%:%
%:%51=25%:%
%:%52=25%:%
%:%57=25%:%
%:%60=26%:%
%:%61=27%:%
%:%62=28%:%
%:%63=29%:%
%:%64=29%:%
%:%65=30%:%
%:%66=31%:%
%:%67=32%:%
%:%68=33%:%
%:%69=33%:%
%:%70=34%:%
%:%73=35%:%
%:%77=35%:%
%:%78=35%:%
%:%79=36%:%
%:%80=36%:%
%:%81=36%:%
%:%86=36%:%
%:%89=37%:%
%:%90=38%:%
%:%91=39%:%
%:%92=39%:%
%:%93=40%:%
%:%94=41%:%
%:%95=42%:%
%:%96=43%:%
%:%97=43%:%
%:%98=44%:%
%:%101=45%:%
%:%105=45%:%
%:%106=45%:%
%:%107=46%:%
%:%108=46%:%
%:%109=46%:%
%:%114=46%:%
%:%117=47%:%
%:%118=48%:%
%:%119=49%:%
%:%120=49%:%
%:%121=50%:%
%:%122=51%:%
%:%123=52%:%
%:%124=53%:%
%:%125=54%:%
%:%126=54%:%
%:%127=55%:%
%:%128=56%:%
%:%129=57%:%
%:%130=58%:%
%:%131=59%:%
%:%132=59%:%
%:%133=60%:%
%:%134=61%:%
%:%135=62%:%
%:%136=63%:%
%:%137=64%:%
%:%138=64%:%
%:%139=65%:%
%:%140=66%:%
%:%141=67%:%
%:%142=68%:%
%:%143=69%:%
%:%144=70%:%
%:%145=70%:%
%:%146=71%:%
%:%147=72%:%
%:%148=73%:%
%:%149=74%:%
%:%150=74%:%
%:%151=75%:%
%:%154=76%:%
%:%158=76%:%
%:%159=76%:%
%:%160=76%:%
%:%165=76%:%
%:%168=77%:%
%:%169=78%:%
%:%170=79%:%
%:%171=80%:%
%:%172=81%:%
%:%173=82%:%
%:%174=83%:%
%:%175=84%:%
%:%176=84%:%
%:%177=85%:%
%:%178=86%:%
%:%180=88%:%
%:%181=89%:%
%:%182=90%:%
%:%183=91%:%
%:%184=92%:%
%:%185=93%:%
%:%186=94%:%
%:%187=94%:%
%:%188=95%:%
%:%191=98%:%
%:%194=99%:%
%:%198=99%:%
%:%199=99%:%
%:%200=100%:%
%:%201=100%:%
%:%202=101%:%
%:%203=101%:%
%:%204=102%:%
%:%205=102%:%
%:%206=103%:%
%:%207=103%:%
%:%208=104%:%
%:%209=104%:%
%:%210=105%:%
%:%211=106%:%
%:%212=106%:%
%:%213=107%:%
%:%214=107%:%
%:%215=108%:%
%:%216=108%:%
%:%217=109%:%
%:%218=109%:%
%:%219=109%:%
%:%220=110%:%
%:%221=110%:%
%:%222=111%:%
%:%223=111%:%
%:%224=111%:%
%:%225=112%:%
%:%226=112%:%
%:%227=113%:%
%:%228=113%:%
%:%229=114%:%
%:%230=114%:%
%:%231=114%:%
%:%232=115%:%
%:%233=115%:%
%:%234=116%:%
%:%235=116%:%
%:%236=117%:%
%:%237=117%:%
%:%238=118%:%
%:%239=118%:%
%:%240=118%:%
%:%241=119%:%
%:%242=119%:%
%:%243=120%:%
%:%244=120%:%
%:%245=121%:%
%:%246=121%:%
%:%247=121%:%
%:%248=122%:%
%:%249=122%:%
%:%250=123%:%
%:%251=123%:%
%:%252=124%:%
%:%253=124%:%
%:%254=125%:%
%:%255=125%:%
%:%256=125%:%
%:%257=126%:%
%:%258=126%:%
%:%259=127%:%
%:%260=127%:%
%:%261=127%:%
%:%262=128%:%
%:%263=128%:%
%:%264=129%:%
%:%265=129%:%
%:%266=130%:%
%:%267=130%:%
%:%268=130%:%
%:%269=131%:%
%:%270=131%:%
%:%271=131%:%
%:%272=132%:%
%:%273=132%:%
%:%274=133%:%
%:%275=133%:%
%:%276=134%:%
%:%277=134%:%
%:%278=134%:%
%:%279=135%:%
%:%280=135%:%
%:%281=136%:%
%:%282=136%:%
%:%283=137%:%
%:%284=137%:%
%:%285=137%:%
%:%286=138%:%
%:%287=138%:%
%:%288=138%:%
%:%289=139%:%
%:%295=139%:%
%:%298=140%:%
%:%299=141%:%
%:%300=142%:%
%:%301=142%:%
%:%302=143%:%
%:%303=144%:%
%:%304=145%:%
%:%305=146%:%
%:%306=147%:%
%:%307=148%:%
%:%308=148%:%
%:%309=149%:%
%:%310=150%:%
%:%311=151%:%
%:%314=152%:%
%:%319=153%:%